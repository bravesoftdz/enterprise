/*
** ATUALIZACAO DE DADOS TRIBUTARIOS
*/

SET TERM ^ ;

CREATE OR ALTER procedure SITTRIBUICMS (
    CODPRODUTO integer,
    SITTRIBUTARIA char(3),
    ICMSVENDA decimal(9,4),
    CODEMPRESA integer)
as
BEGIN

  /* ATUALIZO O TEMPITENS */
  UPDATE
    TEMPITENS
  SET
    TEMPITENS.SITTRIBU = :SITTRIBUTARIA,
    TEMPITENS.ICMSVENDA = :ICMSVENDA
  WHERE
    TEMPITENS.CODPRODUTO = :CODPRODUTO;

  /* ATUALIZO O INDIVIDUAIS */
  UPDATE
    INDIVIDUAIS
  SET
    INDIVIDUAIS.ICMSVENDA = :ICMSVENDA
  WHERE
    INDIVIDUAIS.CODPRODUTO = :CODPRODUTO AND
    INDIVIDUAIS.CODEMPRESA = :CODEMPRESA;

  /* ATUALIZO O PRODUTO */
  UPDATE
    PRODUTOS
  SET
    PRODUTOS.SITTRIBU = :SITTRIBUTARIA,
    PRODUTOS.ICMS = :ICMSVENDA
  WHERE
    PRODUTOS.CODIGO = :CODPRODUTO;

END
^

SET TERM ; ^

INSERT INTO SCRIPTVER(NUMERO, DATA) VALUES (456, CURRENT_TIMESTAMP);
COMMIT;
