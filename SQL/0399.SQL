/*
** CÓDIGO DO PRODUTO LIVRE DE TAMANHO // RESTAURAR O BANCO
*/

ALTER TABLE CLI_PRECOS DROP CONSTRAINT FK_CLI_PRECOS_3;

ALTER TABLE COMPOSICAO DROP CONSTRAINT COMPOSICAO_FK01;

ALTER TABLE ESTOQUE_CM DROP CONSTRAINT ESTOQUE_CM_FK02;

ALTER TABLE ESTOQUE_PEPS DROP CONSTRAINT ESTOQUE_PEPS_FK02;

ALTER TABLE INDIVIDUAIS DROP CONSTRAINT INDIVIDUAIS_FK06;

ALTER TABLE MOVESTOQUE DROP CONSTRAINT MOVESTOQUE_FK01;

ALTER TABLE PRODUTOS_L1 DROP CONSTRAINT PRODUTOS_L1_FK01;

ALTER TABLE PRO_FILES DROP CONSTRAINT PRO_FILES_FK01;

ALTER TABLE TEMPITENS DROP CONSTRAINT TEMPITENS_FK02;

ALTER TABLE VARIACAO_VALOR DROP CONSTRAINT VARIACAO_VALOR_FK01;

ALTER TABLE COMPOSICAO DROP CONSTRAINT PK_COMPOSICAO;

ALTER TABLE COMPOSICAO DROP CONSTRAINT COMPOSICAO_FK02;

ALTER TABLE CONTRATOS DROP CONSTRAINT CONTRATOS_FK05;

COMMIT;

ALTER TABLE PRODUTOS DROP CONSTRAINT PRODUTOS_PK;

COMMIT;

UPDATE RDB$RELATION_FIELDS SET
RDB$FIELD_SOURCE = 'INTEIRO_VALIDO'
WHERE (RDB$FIELD_NAME = 'CODIGO') AND
(RDB$RELATION_NAME = 'PRODUTOS');

COMMIT;

ALTER TABLE PRODUTOS
ADD CONSTRAINT PK_PRODUTOS
PRIMARY KEY (CODIGO);

COMMIT;

ALTER TABLE CONTRATOS
ADD CONSTRAINT FK_CONTRATOS_1
FOREIGN KEY (CODSERVICO)
REFERENCES PRODUTOS(CODIGO)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE COMPOSICAO
ADD CONSTRAINT PK_COMPOSICAO
PRIMARY KEY (CODPRODUTO,CODMATPRIMA);

ALTER TABLE VARIACAO_VALOR
ADD CONSTRAINT FK_VARIACAO_VALOR_1
FOREIGN KEY (CODPRODUTO)
REFERENCES PRODUTOS(CODIGO)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE TEMPITENS
ADD CONSTRAINT FK_TEMPITENS_1
FOREIGN KEY (CODPRODUTO)
REFERENCES PRODUTOS(CODIGO)
ON UPDATE CASCADE;

ALTER TABLE PRO_FILES
ADD CONSTRAINT FK_PRO_FILES_1
FOREIGN KEY (CODPRODUTO)
REFERENCES PRODUTOS(CODIGO)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE PRODUTOS_L1
ADD CONSTRAINT FK_PRODUTOS_L1_1
FOREIGN KEY (CODIGO)
REFERENCES PRODUTOS(CODIGO)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE MOVESTOQUE
ADD CONSTRAINT FK_MOVESTOQUE_1
FOREIGN KEY (CODPRODUTO)
REFERENCES PRODUTOS(CODIGO)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE INDIVIDUAIS
ADD CONSTRAINT FK_INDIVIDUAIS_1
FOREIGN KEY (CODPRODUTO)
REFERENCES PRODUTOS(CODIGO)
ON UPDATE CASCADE;

ALTER TABLE COMPOSICAO
ADD CONSTRAINT FK_COMPOSICAO_1
FOREIGN KEY (CODPRODUTO)
REFERENCES PRODUTOS(CODIGO)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE CLI_PRECOS
ADD CONSTRAINT FK_CLI_PRECOS_2
FOREIGN KEY (CODPRODUTO)
REFERENCES PRODUTOS(CODIGO)
ON DELETE CASCADE
ON UPDATE CASCADE;

INSERT INTO SCRIPTVER(NUMERO, DATA) VALUES (399, CURRENT_TIMESTAMP);
COMMIT;
